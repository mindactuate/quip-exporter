{"version":3,"sources":["globalStore.js","exporter/exporter.js","config.js","assets/pf_sq_low-res.jpg","assets/Logo_Quip-Exporter.png","assets/icon_donate.png","App.jsx","serviceWorker.js","index.js"],"names":["globalStore","store","log","addToLog","string","unshift","Date","toLocaleString","clearLog","quipToken","zipFile","rootDir","exportPaused","exportPausedByUser","donated","running","finished","zipFileFinished","numAPIcalls","patiently","require","config","mdService","turndown","zipService","jszip","waiter","LimitWaiter","startWaitingCallback","res","console","endWaitingCallback","waitingTickCallback","minutelyLimit","hourlyLimit","msBetweenTwoCalls","test","clean","path","startExporting","getUser","user","sharedFolderIds","sharedFolderChildren","Array","isArray","forEach","folderId","push","folder_id","sharedFolder","children","folder","id","title","getFolder","privateFolder","waterfallOverFolder","processObj","tree","callbackQueue","length","totalC","setTimeout","generateAsync","type","then","blob","callback","a","wait","url","default","quipHost","axios","get","headers","Authorization","data","name","catch","err","JSON","stringify","message","response","status","iterator","nextItemIndex","cleanName","report","pop","str","tr","ä","ü","ö","ß","Ä","Ü","Ö","replace","$0","waitForUnpause","Promise","resolve","interval","setInterval","clearInterval","obj","hasOwnProperty","getThread","thread","threadName","threadFilePath","join","extractAndReplaceImgsInHTML","html","createHTMLAndMdFile","fetchDocxAndWriteToFile","threadId","threadTitle","m","images","rex","exec","imageFolderName","substr","imageFileName","imageFilePath","imageUrl","blobPath","fetchImageAndWriteToFile","responseType","imgString","Buffer","from","file","binary","shift","fileString","body","exporter","App","at","document","getElementById","value","window","open","saveAs","valign","src","logo","alt","className","avatar","href","target","donateIcon","style","color","width","height","autoComplete","hidden","disabled","onClick","pauseExportingByUser","downloadZip","backgroundColor","donateAndContinue","map","val","React","Component","view","Boolean","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.91b75201.chunk.js","sourcesContent":["import { store } from \"@risingstack/react-easy-state\";\r\n\r\nlet globalStore = store({\r\n  log: [],\r\n  addToLog: string => {\r\n    globalStore.log.unshift(`${new Date().toLocaleString()}: ${string}`);\r\n  },\r\n  clearLog: () => {\r\n    globalStore.log = [];\r\n  },\r\n  quipToken: \"\",\r\n  zipFile: null,\r\n  rootDir: null,\r\n  exportPaused: false,\r\n  exportPausedByUser: false,\r\n  donated: false,\r\n  running: false,\r\n  finished: false,\r\n  zipFileFinished: false,\r\n  numAPIcalls: 0\r\n});\r\n\r\nexport default globalStore;\r\n","import globalStore from \"../globalStore\";\r\nimport axios from \"axios\";\r\nimport turndown from \"turndown\";\r\nimport jszip from \"jszip\";\r\n\r\n// https://quip.com/api/personal-token\r\n\r\nconst patiently = require(\"patiently\");\r\n// const fs = require(\"file-system\");\r\n// const Path = require(\"path\");\r\nconst config = require(\"../config\");\r\n\r\nlet mdService = new turndown();\r\nlet zipService = new jszip();\r\n\r\nlet waiter = new patiently.LimitWaiter({\r\n  startWaitingCallback: (res) => console.log(res),\r\n  endWaitingCallback: (res) => console.log(res),\r\n  waitingTickCallback: (res) => console.log(res),\r\n  minutelyLimit: 50,\r\n  hourlyLimit: 750,\r\n  msBetweenTwoCalls: 0,\r\n  test: false,\r\n});\r\n\r\nlet d = new Date();\r\nlet rootDir = clean(d.toLocaleString());\r\nvar path = [rootDir];\r\n// let numAPICallsToPause = 50;\r\nlet numAPICallsToPause = 20;\r\n\r\nexport let startExporting = function (quipToken) {\r\n  if (quipToken) {\r\n    globalStore.running = true;\r\n    globalStore.quipToken = quipToken; // \"cache\" quip token\r\n    globalStore.addToLog(`Got access token: ${quipToken}`);\r\n    globalStore.addToLog(`Start exporting`);\r\n    getUser((user) => {\r\n      let sharedFolderIds = user[\"shared_folder_ids\"];\r\n      let sharedFolderChildren = [];\r\n      if (Array.isArray(sharedFolderIds)) {\r\n        sharedFolderIds.forEach((folderId) => {\r\n          sharedFolderChildren.push({ folder_id: folderId });\r\n        });\r\n      }\r\n      let sharedFolder = {\r\n        children: sharedFolderChildren,\r\n        folder: {\r\n          id: \"12345\",\r\n          title: \"Shared\",\r\n        },\r\n      };\r\n      getFolder(user[\"private_folder_id\"], (privateFolder) => {\r\n        console.log(\"loop over private folder docs\");\r\n        waterfallOverFolder(privateFolder, processObj, function (tree) {\r\n          console.log(\"In queue:\", waiter.callbackQueue.length);\r\n          console.log(\"loop over shared folders\");\r\n          waterfallOverFolder(sharedFolder, processObj, function (tree) {\r\n            globalStore.addToLog(\"Finished exporting\");\r\n            globalStore.addToLog(\"Used \" + waiter.totalC + \" api calls\");\r\n            globalStore.addToLog(\"Creating zip file\");\r\n\r\n            setTimeout(() => {\r\n              zipService.generateAsync({ type: \"blob\" }).then(function (blob) {\r\n                globalStore.addToLog(`Zip file ${rootDir} created`);\r\n                globalStore.zipFile = blob;\r\n                globalStore.rootDir = rootDir;\r\n                globalStore.zipFileFinished = true;\r\n                globalStore.finished = true;\r\n                globalStore.running = false;\r\n              });\r\n            }, 10000);\r\n          });\r\n        });\r\n      });\r\n    });\r\n  } else {\r\n    globalStore.addToLog(`No access token delivered`);\r\n    globalStore.addToLog(`Please deliver access token`);\r\n    globalStore.running = false;\r\n  }\r\n};\r\n\r\nlet getUser = async (callback) => {\r\n  waiter.wait(() => {\r\n    let url = `${config.default.quipHost}users/current`;\r\n    axios.default\r\n      .get(url, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + globalStore.quipToken,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        if (res && res.data) {\r\n          let user = res.data;\r\n          console.log(user);\r\n          globalStore.addToLog(\r\n            `Received user object with the user's name ${user.name}`\r\n          );\r\n          callback(user);\r\n        } else {\r\n          globalStore.addToLog(`No user object received`);\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        globalStore.running = false;\r\n        globalStore.addToLog(\r\n          `Error while getting user: ${JSON.stringify(err.message)}`\r\n        );\r\n        if (\r\n          err.response &&\r\n          err.response.status &&\r\n          err.response.status === 401\r\n        ) {\r\n          globalStore.addToLog(\"Your access token seems to be invalid.\");\r\n        }\r\n      });\r\n  });\r\n};\r\n\r\nlet getFolder = async (id, callback) => {\r\n  waiter.wait(() => {\r\n    let url = `${config.default.quipHost}folders/${id}`;\r\n    axios.default\r\n      .get(url, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + globalStore.quipToken,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        if (res && res.data) {\r\n          let folder = res.data;\r\n          console.log(folder);\r\n          globalStore.addToLog(\r\n            `Start exporting folder with the title ${folder.folder.title}`\r\n          );\r\n          callback(folder);\r\n        } else {\r\n          globalStore.addToLog(`No folder object received`);\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        globalStore.running = false;\r\n        globalStore.addToLog(\r\n          `Error while getting folder: ${JSON.stringify(err.message)}`\r\n        );\r\n        if (\r\n          err.response &&\r\n          err.response.status &&\r\n          err.response.status === 401\r\n        ) {\r\n          globalStore.addToLog(\"Your access token seems to be invalid.\");\r\n        }\r\n      });\r\n  });\r\n};\r\n\r\n// https://mostafa-samir.github.io/async-iterative-patterns-pt1/\r\nfunction waterfallOverFolder(folder, iterator, callback) {\r\n  var tree = {};\r\n  const id = folder.folder.id;\r\n  tree[id] = [];\r\n  var nextItemIndex = 0;\r\n  const length = folder.children.length;\r\n  const name = folder.folder.title;\r\n  const cleanName = clean(name);\r\n\r\n  path.push(cleanName);\r\n\r\n  // createFolder(path.join('/')); // folder will be generated directly in zip\r\n\r\n  function report(res) {\r\n    if (res) {\r\n      tree[id].push(res);\r\n    }\r\n    nextItemIndex++;\r\n    if (nextItemIndex === length) {\r\n      path.pop();\r\n      callback(tree);\r\n    } else {\r\n      iterator(folder.children[nextItemIndex], report);\r\n    }\r\n  }\r\n\r\n  // had the case of an empty folder with 0 children\r\n  if (length > 0) {\r\n    iterator(folder.children[0], report);\r\n  } else {\r\n    path.pop();\r\n    callback(tree);\r\n  }\r\n}\r\n\r\n// https://stackoverflow.com/questions/1909815/regex-to-compare-strings-with-umlaut-and-non-umlaut-variations\r\n// https://stackoverflow.com/questions/4374822/remove-all-special-characters-with-regexp\r\nfunction clean(str) {\r\n  let tr = { ä: \"ae\", ü: \"ue\", ö: \"oe\", ß: \"ss\", Ä: \"Ae\", Ü: \"Ue\", Ö: \"Oe\" };\r\n  let clean = str.replace(/[^A-Za-z0-9äöüÄÖÜß]/gi, \"\");\r\n  clean = clean.replace(/[äöüÄÖÜß]/g, function ($0) {\r\n    return tr[$0];\r\n  });\r\n  return clean;\r\n}\r\n\r\nfunction waitForUnpause() {\r\n  return new Promise((resolve) => {\r\n    let interval = setInterval(() => {\r\n      console.log(`paused: ${globalStore.exportPaused}, paused by User: ${globalStore.exportPausedByUser}, running: ${globalStore.running}`);\r\n      if (!globalStore.exportPaused && !globalStore.exportPausedByUser) {\r\n        clearInterval(interval);\r\n        resolve();\r\n      }\r\n    }, 2000);\r\n  });\r\n}\r\n\r\n// iterator\r\nasync function processObj(obj, report) {\r\n  if (waiter.totalC > numAPICallsToPause && !globalStore.donated) {\r\n    globalStore.numAPIcalls = waiter.totalC;\r\n    globalStore.exportPaused = true; // pause export and ask for donation\r\n    globalStore.running = false;\r\n    globalStore.zipFile = null;\r\n    globalStore.addToLog(\"Creating zip file\");\r\n\r\n    setTimeout(() => {\r\n      zipService.generateAsync({ type: \"blob\" }).then(function (blob) {\r\n        globalStore.addToLog(`Zip file ${rootDir}_demo created`);\r\n        globalStore.zipFile = blob;\r\n        globalStore.rootDir = rootDir + \"_demo\";\r\n        globalStore.zipFileFinished = true;\r\n      });\r\n    }, 10000);\r\n    await waitForUnpause();\r\n    globalStore.running = true;\r\n  }\r\n  if (globalStore.exportPausedByUser) {\r\n    globalStore.zipFile = null;\r\n    globalStore.addToLog(\"Creating zip file\");\r\n\r\n    setTimeout(() => {\r\n      zipService.generateAsync({ type: \"blob\" }).then(function (blob) {\r\n        globalStore.addToLog(`Zip file ${rootDir}_interim created`);\r\n        globalStore.zipFile = blob;\r\n        globalStore.rootDir = rootDir + \"_interim\";\r\n        globalStore.zipFileFinished = true;\r\n      });\r\n    }, 10000);\r\n    await waitForUnpause();\r\n    globalStore.running = true;\r\n  }\r\n  if (obj.hasOwnProperty(\"thread_id\")) {\r\n    getThread(obj[\"thread_id\"], (thread) => {\r\n      let threadName = clean(thread.thread.title);\r\n\r\n      path.push(threadName);\r\n      let threadFilePath = path.join(\"/\");\r\n      path.pop();\r\n\r\n      extractAndReplaceImgsInHTML(\r\n        thread.html,\r\n        thread.thread.id,\r\n        threadName,\r\n        (html) => {\r\n          createHTMLAndMdFile(threadFilePath, thread.thread.title, html);\r\n          fetchDocxAndWriteToFile(obj[\"thread_id\"], threadFilePath);\r\n          report(obj[\"thread_id\"]);\r\n        }\r\n      );\r\n    });\r\n  } else if (obj.hasOwnProperty(\"folder_id\")) {\r\n    getFolder(obj[\"folder_id\"], (folder) => {\r\n      // recursion\r\n      waterfallOverFolder(folder, processObj, function (tree) {\r\n        report(tree);\r\n      });\r\n    });\r\n  } else {\r\n    report(null);\r\n  }\r\n}\r\n\r\nlet getThread = async (id, callback) => {\r\n  waiter.wait(() => {\r\n    let url = `${config.default.quipHost}threads/${id}`;\r\n    axios.default\r\n      .get(url, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + globalStore.quipToken,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        if (res && res.data && res.data.thread) {\r\n          let thread = res.data;\r\n          globalStore.addToLog(\r\n            `Start exporting thread with the title ${clean(\r\n              thread.thread.title\r\n            )}`\r\n          );\r\n          callback(thread);\r\n        } else {\r\n          globalStore.addToLog(\r\n            `Lost thread with the id ${id}, please check with https://platform.quip.com/1/threads/${id}`\r\n          );\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        globalStore.addToLog(\r\n          `Error while getting thread: ${JSON.stringify(err.message)}`\r\n        );\r\n        if (\r\n          err.response &&\r\n          err.response.status &&\r\n          err.response.status === 401\r\n        ) {\r\n          globalStore.addToLog(\"Your access token seems to be invalid.\");\r\n        }\r\n      });\r\n  });\r\n};\r\n\r\nfunction extractAndReplaceImgsInHTML(html, threadId, threadTitle, callback) {\r\n  var m;\r\n  var images = [];\r\n\r\n  // https://stackoverflow.com/questions/14939296/extract-image-src-from-a-string\r\n  const rex = /<img.*?src='([^\">]*\\/([^\">]*?))'.*?>/gm;\r\n\r\n  while ((m = rex.exec(html))) {\r\n    let imageFolderName =\r\n      \"_images_\" + threadTitle.substr(0, 6) + \"_\" + threadId;\r\n    let imageFileName = threadTitle.substr(0, 6) + \"_\" + images.length + \".png\";\r\n\r\n    path.push(imageFolderName);\r\n    path.push(imageFileName);\r\n    let imageFilePath = path.join(\"/\");\r\n    path.pop();\r\n    path.pop();\r\n\r\n    let imageUrl = imageFolderName + \"/\" + imageFileName;\r\n\r\n    let blobPath = m[1];\r\n    blobPath = blobPath.substr(1, blobPath.length); // delete / at the beginning\r\n\r\n    images.push({\r\n      blobPath: blobPath,\r\n      imageUrl: imageUrl,\r\n      imageFilePath: imageFilePath,\r\n    });\r\n\r\n    html = html.replace(m[1], imageUrl);\r\n  }\r\n\r\n  fetchImageAndWriteToFile(images, function () {\r\n    callback(html);\r\n  });\r\n}\r\n\r\nfunction fetchImageAndWriteToFile(images, callback) {\r\n  if (images.length > 0) {\r\n    let path = images[0].blobPath;\r\n    let imageFilePath = images[0].imageFilePath;\r\n\r\n    waiter.wait(() => {\r\n      let url = config.default.quipHost + path;\r\n      axios.default\r\n        .get(url, {\r\n          headers: {\r\n            Authorization: \"Bearer \" + globalStore.quipToken,\r\n          },\r\n          responseType: \"arraybuffer\",\r\n        })\r\n        .then((res) => {\r\n          let imgString = new Buffer.from(res.data, \"binary\");\r\n          zipService.file(imageFilePath, imgString, { binary: true });\r\n          globalStore.addToLog(`Image ${imageFilePath} written`);\r\n\r\n          images.shift();\r\n          fetchImageAndWriteToFile(images, callback);\r\n        })\r\n        .catch((err) => {\r\n          globalStore.addToLog(\r\n            `Error while fetching image file ${imageFilePath}`\r\n          );\r\n\r\n          images.shift();\r\n          fetchImageAndWriteToFile(images, callback);\r\n        });\r\n    });\r\n  } else {\r\n    callback();\r\n  }\r\n}\r\n\r\nfunction fetchDocxAndWriteToFile(threadId, path) {\r\n  if (threadId) {\r\n    waiter.wait(() => {\r\n      let url = `${config.default.quipHost}threads/${threadId}/export/docx`;\r\n      axios.default\r\n        .get(url, {\r\n          headers: {\r\n            Authorization: \"Bearer \" + globalStore.quipToken,\r\n          },\r\n          responseType: \"arraybuffer\",\r\n        })\r\n        .then((res) => {\r\n          let fileString = new Buffer.from(res.data, \"binary\");\r\n          zipService.file(path + \".docx\", fileString, { binary: true });\r\n          globalStore.addToLog(`Docx ${path} written`);\r\n        })\r\n        .catch((err) => {\r\n          globalStore.addToLog(`Error while fetching docx file ${path}`);\r\n        });\r\n    });\r\n  }\r\n}\r\n\r\nfunction createHTMLAndMdFile(path, title, body) {\r\n  let html =\r\n    \"<!doctype html><html><head><title>\" +\r\n    title +\r\n    '</title><meta charset=\"UTF-8\"></head><body>';\r\n  html += body;\r\n  html += \"</body></html>\";\r\n  zipService.file(path + \".html\", html);\r\n  zipService.file(path + \".md\", mdService.turndown(html));\r\n  globalStore.addToLog(`Documents ${path}.md & .html written`);\r\n}\r\n","let config = {\r\n    // quipHost: \"https://platform.quip.com/1/\"\r\n    quipHost: \"https://old-rain-a483.mindactuate.workers.dev/?apiurl=https://platform.quip.com/1/\" // 100.000 per day, 1.000 per 10 minutes\r\n}\r\n\r\nexport default config;","export default __webpack_public_path__ + \"static/media/pf_sq_low-res.67450953.jpg\";","export default __webpack_public_path__ + \"static/media/Logo_Quip-Exporter.63c2e751.png\";","export default __webpack_public_path__ + \"static/media/icon_donate.ef03c9d7.png\";","import React from \"react\";\r\nimport { view } from \"@risingstack/react-easy-state\";\r\nimport globalStore from \"./globalStore\";\r\nimport avatar from \"./assets/pf_sq_low-res.jpg\";\r\nimport logo from \"./assets/Logo_Quip-Exporter.png\";\r\nimport donateIcon from \"./assets/icon_donate.png\";\r\nimport { saveAs } from \"file-saver\";\r\n\r\nlet exporter = require(\"./exporter/exporter\");\r\n\r\n// https://quip.com/api/personal-token\r\n\r\nclass App extends React.Component {\r\n  startExporting() {\r\n    globalStore.zipFileFinished = false;\r\n    if(!globalStore.running && !globalStore.exportPaused && !globalStore.exportPausedByUser){\r\n      globalStore.finished = false;\r\n      let at = document.getElementById(\"accesstoken\").value;\r\n      exporter.startExporting(at);\r\n    } else if (globalStore.exportPausedByUser){\r\n      globalStore.exportPausedByUser = false;\r\n      globalStore.running = true;\r\n    }\r\n  }\r\n\r\n  donateAndContinue() {\r\n    window.open(\"https://paypal.me/mindactuate\", \"_blank\");\r\n    globalStore.donated = true;\r\n    globalStore.exportPaused = false;\r\n  }\r\n\r\n  downloadZip() {\r\n    saveAs(globalStore.zipFile, globalStore.rootDir);\r\n  }\r\n\r\n  pauseExportingByUser(){\r\n    globalStore.zipFileFinished = false;\r\n    globalStore.exportPausedByUser = true;\r\n    globalStore.running = false;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div id=\"container\">\r\n          <div id=\"content-left\">\r\n            <h1>The Quip Exporter</h1>\r\n            <table>\r\n              <tbody>\r\n                <tr>\r\n                  <td valign=\"top\">\r\n                    <img src={logo} alt=\"logo\" className=\"smallImages\" />\r\n                  </td>\r\n                  <td valign=\"top\">\r\n                    <p>\r\n                      Quip is a great tool to create well formatted documents on\r\n                      desktop as well as on mobile devices. Unfortunately it\r\n                      lacks two important features:\r\n                    </p>\r\n                    <ol>\r\n                      <li>To export all documents at once</li>\r\n                      <li>To export to html or md including image files</li>\r\n                    </ol>\r\n                    <p>This tool will perform a</p>\r\n                    <ul>\r\n                      <li>\r\n                        <span id=\"highlight\">full export</span> of your Quip\r\n                        account's{\" \"}\r\n                      </li>\r\n                      <li>\r\n                        <span id=\"highlight\">private &amp; shared folders</span>\r\n                        .\r\n                      </li>\r\n                    </ul>\r\n                    <p>The files will be exported as</p>\r\n                    <ul>\r\n                      <li>\r\n                        <span id=\"highlight\">HTML, md &amp; docx</span> files\r\n                      </li>\r\n                      <li>\r\n                        <span id=\"highlight\">including all of your images</span>\r\n                        .\r\n                      </li>\r\n                    </ul>\r\n                    <p>\r\n                      Please keep in mind that it will not loop through your\r\n                      recycle bin and starred folder.\r\n                    </p>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n            <h2>About me and ref to Github</h2>\r\n            <table>\r\n              <tbody>\r\n                <tr>\r\n                  <td valign=\"top\">\r\n                    <img src={avatar} alt=\"avatar\" className=\"smallImages\" />\r\n                  </td>\r\n                  <td valign=\"top\">\r\n                    <p>\r\n                      My name is Daniel Gruner, I am a software engineer from Germany.\r\n                      Find me at Github under{\" \"}\r\n                      <a href=\"https://github.com/mindactuate\" target=\"blank\">\r\n                        github.com/mindactuate\r\n                      </a>{\" \"}\r\n                      or at dev.to under{\" \"}\r\n                      <a href=\"https://dev.to/mindactuate\" target=\"blank\">\r\n                        dev.to/mindactuate\r\n                      </a>\r\n                      .\r\n                      <br />\r\n                      <br />\r\n                      Or you can send me an email to dnlgrnr911[at]gmail.com.\r\n                      <br />\r\n                      <br />\r\n                      You can find the code repository of this app{\" \"}\r\n                      <a\r\n                        href=\"https://github.com/mindactuate/quip-exporter\"\r\n                        target=\"blank\"\r\n                      >\r\n                        here\r\n                      </a>\r\n                      .\r\n                    </p>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n            <h2>Impressum and privacy</h2>\r\n            <p>\r\n              You can find the impressum and gdpr privacy in German under{\" \"}\r\n              <a\r\n                href=\"https://mindactuate.github.io/impressum-datenschutz/\"\r\n                target=\"blank\"\r\n              >\r\n                mindactuate.github.io/impressum-datenschutz/\r\n              </a>\r\n            </p>\r\n          </div>\r\n          <div id=\"content-right\">\r\n            <h2>Donating</h2>\r\n            <table>\r\n              <tbody>\r\n                <tr>\r\n                  <td valign=\"top\">\r\n                    <a\r\n                      href=\"https://paypal.me/mindactuate\"\r\n                      target=\"blank\"\r\n                    >\r\n                      <img\r\n                        src={donateIcon}\r\n                        alt=\"donateIcon\"\r\n                        className=\"smallImages\"\r\n                      />\r\n                    </a>\r\n                  </td>\r\n                  <td valign=\"top\">\r\n                    <p>\r\n                      This app is a lot of work. Please consider donating just a\r\n                      little. :) You can{\" \"}\r\n                      <a\r\n                        href=\"https://paypal.me/mindactuate\"\r\n                        target=\"blank\"\r\n                      >\r\n                        paypal me\r\n                      </a>\r\n                      . That´s an effort of 5 seconds.\r\n                    </p>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n            <h2>Access token</h2>\r\n            <p>\r\n              Please get your Quip access token from{\" \"}\r\n              <a href=\"https://quip.com/dev/token\" target=\"blank\">\r\n                quip.com/dev/token\r\n              </a>{\" \"}\r\n              and paste it into the form input.\r\n              <br />\r\n              <br />\r\n              <s>\r\n                You can be sure that your token is used only locally in your web\r\n                browser and is not transmitted anywhere else but{\" \"}\r\n                <a\r\n                  href=\"https://quip.com/dev/automation/documentation\"\r\n                  target=\"blank\"\r\n                >\r\n                  platform.quip.com\r\n                </a>{\" \"}\r\n                Therefore you can check the network traffic with help of the\r\n                developer tools from your browser.\r\n              </s>{\" \"}\r\n              <b style={{ color: \"red\" }}>Important note:</b> I am currently in\r\n              contact with Quip to get a CORS trust for my github page.\r\n              Temporarily I have implemented a Cloudflare cors-proxy as\r\n              man-in-the-middle. You can find the code for the cors-proxy in my\r\n              repository. Unfortunately I only have 100.000 free calls per day\r\n              on Cloudflare. I hope to find a solution with Quip soon.\r\n            </p>\r\n            <div id=\"tokenform\">\r\n              <label>Quip Access token</label>\r\n              <br />\r\n              <input\r\n                type=\"text\"\r\n                id=\"accesstoken\"\r\n                name=\"accesstoken\"\r\n                style={{ width: \"100%\", height: \"30px\" }}\r\n                autoComplete=\"off\"\r\n              />\r\n            </div>\r\n            <h2>Start exporting</h2>\r\n            <p>\r\n              After hitting the button the exporter starts to export. Please\r\n              have an eye on the Logs. Depending on how many documents and how\r\n              many images you have, the export process can last multiple hours\r\n              or even days. The reason is that Quip limits the number of API\r\n              requests per minute and per hour for each API token. Please keep\r\n              this window open and your PC running.\r\n              <br />\r\n              <br />\r\n              <b style={{ color: \"red\" }}>\r\n                Do not close or refresh this window / tab while exporting.\r\n              </b>\r\n              <br />\r\n              <br /> After the export is complete you can download a zip (which\r\n              is generated and filled by your browser on the run.)\r\n            </p>\r\n            <div hidden={globalStore.running}>\r\n              <input\r\n                type=\"button\"\r\n                value=\"Start exporting\"\r\n                disabled={globalStore.exportPaused}\r\n                style={{ width: \"100%\", height: \"50px\" }}\r\n                onClick={() => this.startExporting()}\r\n              />\r\n            </div>\r\n            <div hidden={!globalStore.running}>\r\n              <input\r\n                type=\"button\"\r\n                value=\"Pause exporting and download zip\"\r\n                style={{ width: \"100%\", height: \"50px\" }}\r\n                onClick={() => this.pauseExportingByUser()}\r\n              />\r\n              <p>\r\n                <b style={{ color: \"limegreen\" }}>&#9679; Export running</b>\r\n              </p>\r\n            </div>\r\n            <div hidden={!globalStore.exportPausedByUser}>\r\n              <p>Your paused your export. You can download your current zip or continue with exporting.</p>\r\n              <input\r\n                type=\"button\"\r\n                disabled={!globalStore.zipFileFinished}\r\n                value={`${globalStore.zipFileFinished ? \"Download zip\" : \"Wait for zip...\"}`}\r\n                id=\"callToAction\"\r\n                onClick={() => this.downloadZip()}\r\n              />\r\n            </div>\r\n            <div hidden={!globalStore.exportPaused}>\r\n              <p>\r\n                You exported <b>{globalStore.numAPIcalls}</b> documents and\r\n                images now. A friendly reminder:{\" \"}\r\n                <b>Please donate just a little.</b> You can also download the\r\n                current zip and have a look at the files.\r\n              </p>\r\n              <input\r\n                type=\"button\"\r\n                disabled={!globalStore.zipFileFinished}\r\n                value={`${globalStore.zipFileFinished ? \"Download zip\" : \"Wait for zip...\"}`}\r\n                id=\"callToAction\"\r\n                onClick={() => this.downloadZip()}\r\n              />\r\n              <input\r\n                type=\"button\"\r\n                value=\"Donate and continue\"\r\n                id=\"callToAction\"\r\n                style={{ backgroundColor: \"gold\" }}\r\n                onClick={() => this.donateAndContinue()}\r\n              />\r\n            </div>\r\n            <div hidden={!globalStore.finished}>\r\n              <p>Your export is finished.</p>\r\n              <input\r\n                type=\"button\"\r\n                disabled={!globalStore.zipFileFinished}\r\n                value={`${globalStore.zipFileFinished ? \"Download zip\" : \"Wait for zip...\"}`}\r\n                style={{\r\n                  width: \"100%\",\r\n                  height: \"50px\",\r\n                  backgroundColor: \"gold\",\r\n                }}\r\n                onClick={() => this.downloadZip()}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <h2>Log</h2>\r\n        <div id=\"logarea\">\r\n          {globalStore.log.map((val) => (\r\n            <pre>{val}</pre>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default view(App);\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}